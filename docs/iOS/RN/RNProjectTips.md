---
title: RN å¼€å‘é¡¹ç›® çç¢ç§¯ç´¯
date: 2019-12-19 10:45:13
sidebarDepth: 4
categories: 
 - iOS
tags: 
 - RN
---
[[toc]]
[TOC]


# RN å¼€å‘é¡¹ç›® çç¢ç§¯ç´¯

### å›è°ƒå‡½æ•°çš„å†™æ³•
ä»cell è§¦å‘äº‹ä»¶ å›è°ƒåˆ° FlatList æ‰€åœ¨çš„ class ï¼Œç„¶åç”±classå¤„ç†æ—¶é—´ï¼Œæ¯”å¦‚ä¿®è¯¥cellé«˜åº¦ç­‰

```jsx
//åœ¨FlatList calss å†…ï¼Œæ¸²æŸ“ Item çš„æ—¶å€™ ,ä¼ å…¥ä¸€ä¸ª func ,è¯¥å‡½æ•°ä¸ºæœ¬classçš„å‡½æ•°
<Item data={item} func={this._pressedCell} displayMore={displayMore}></Item>

_pressedCell = (object) => {
    
}
    
//åœ¨ cell å†… å°±å¯ä»¥æ‹¿åˆ°è¯¥ funcï¼Œç„¶åè§¦å‘è¯¥å‡½æ•°å°±ï¼ŒåŒæ—¶ä¼ å‚
_pressEvent = () => {
    this.props.func(this.props.data);
}

```



### æŠŠ  FlatList æ‰€åœ¨çš„ class å±æ€§ä¼ ç»™ cell

```jsx
//å†™æ³•å¦‚ä¸‹ï¼Œä¼ å…¥ {...this.props}
<SomeOtherWidget
    {...this.props}
    onPress={this._onPress}
/>
```



### FlatListé«˜åº¦è®¡ç®—

FlatList ä¸éœ€è¦è®¡ç®—é«˜åº¦ï¼Œæœ¬èº«è‡ªå·±ä¼šè®¡ç®—é«˜åº¦ï¼Œæ‰€ä»¥ä½¿ç”¨ FlatList ä»£æ›¿ ListView å’Œ TCList



### FloxBox å¸ƒå±€

FloxBox å¸ƒå±€åˆ†ä¸ºä¸‰ç§ï¼š

* FlexBox å¸ƒå±€
* positoin absolute ç»å¯¹å¸ƒå±€
* position relative ç›¸å¯¹å¸ƒå±€ï¼Œè¯¥å¸ƒå±€ä¸‹ï¼Œå°±æ˜¯ç®€å•çš„æµå¸ƒå±€ï¼Œåªèƒ½ä½¿ç”¨ left top ,ä¸èƒ½ä½¿ç”¨ right bottom



### ç®­å¤´å‡½æ•° ä¸ bind å‡½æ•°çš„åŒºåˆ«

æ³¨æ„ ç®­å¤´å‡½æ•° ä¸ bind å‡½æ•°çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼Œåœ¨ render å‡½æ•°é‡Œæ¸²æŸ“ç»„ä»¶çš„æ—¶å€™ï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ï¼Œè¿™æ ·åœ¨FlatListé‡Œä¼šé¿å…å¤šä½™çš„æ¸²æŸ“ï¼Œå…·ä½“å‚è§ [bindå’Œç®­å¤´å‡½æ•°ï¼Œå“ªä¸ªæ›´å¥½å‘¢ï¼Ÿ](http://bbs.reactnative.cn/topic/2480/bind%E5%92%8C%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0-%E5%93%AA%E4%B8%AA%E6%9B%B4%E5%A5%BD%E5%91%A2)



### å…³äº React ä¸­çš„ ref

å…³äº React ä¸­çš„ refï¼Œå¯ä»¥å‚è§ [å¼„æ‡‚ React çš„ refï¼Œç†è§£ React çš„å®ä¾‹ä¸ vDom ä¹‹é—´çš„å…³ç³»](https://www.jianshu.com/p/4e2357ea1ba1)



### JS ä¸­ æ•°ç»„çš„å¤åˆ¶

Js ä¸­ æ•°ç»„çš„å¤åˆ¶ å¯ä»¥ä½¿ç”¨ï¼š

```jsx
var colors = ["red", "green", "blue"];
var colors2 = colors.concat("yellow", ["black", "brown"]);
```



### ä¿®æ”¹å­ç»„ä»¶çš„ stateï¼Œç»è¿‡æµ‹è¯•æ˜¯ä¸ä¼šåˆ·æ–°çŠ¶æ€çš„



### å…³äºåŠ¨æ€è®¡ç®— `Text`

å…³äºåŠ¨æ€è®¡ç®— `Text`ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼Œå½“æ–‡æœ¬çš„é«˜åº¦è¶…è¿‡5è¡Œæ—¶éœ€è¦æŠ˜å æ–‡æœ¬ï¼Œåœ¨RNé‡Œç›®å‰ä¸èƒ½é¢„å…ˆè®¡ç®—é«˜åº¦ï¼Œåªèƒ½é€šè¿‡ `onLayout` å‡½æ•°æ‹¿åˆ°å±•ç¤ºåçš„é«˜åº¦ï¼Œç„¶åå»è¿›è¡Œé€»è¾‘æ§åˆ¶ï¼Œç›®å‰æ€§èƒ½é—®é¢˜æš‚æ—¶æœªçŸ¥



### å¯Œæ–‡æœ¬é—®é¢˜

å¯Œæ–‡æœ¬é—®é¢˜ï¼Œæ¯”å¦‚ï¼Œä¸€ä¸ªæ–‡æœ¬è¦ä¸åŒçš„å­—æ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼Œåœ¨RNé‡Œæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ç”¨ `Text` åµŒå¥—å°±å¯ä»¥äº†ï¼Œ`å­Text`ä¼šç»§æ‰¿`çˆ¶Text`çš„å±æ€§ï¼Œç„¶åé‡æ–°è®¾ç½®è¦æ”¹å˜çš„styleå³å¯



### `Text`ç»„ä»¶çš„ `borderRadius`ä¸èµ·ä½œç”¨ï¼Œéœ€è¦å¤–éƒ¨åŒ…è£¹`View`æ¥å®ç°



### react-devtools

ä» `RN 0.43`å¼€å§‹ï¼Œå®˜æ–¹å¢åŠ äº† **react-devtools** å·¥å…·ï¼Œå¯ä»¥å®¡æŸ¥RNå…ƒç´ 

```shell
//å®‰è£…
npm install -g react-devtools

//è¿è¡Œ
react-devtools
```



### `flex:1` çš„é”™è¯¯

çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œä¸€ä¸ª`View`å†…ï¼Œä¸Šä¸‹æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œä¸Šéƒ¨å…ƒç´ æ˜¯æ ¹æ®å†…å®¹å†³å®šé«˜åº¦ï¼Œä¸‹éƒ¨å…ƒç´ æ˜¯ä¸€ä¸ªé«˜åº¦å›ºå®šä¸º10çš„`View`ï¼Œä½†æ˜¯éƒ½è®¾ç½®äº† `flex: 1`ï¼Œå¼€å§‹æ˜¯æƒ³è®©ä¸‹éƒ¨å…ƒç´ çš„å®½åº¦æ’‘åˆ°å±å¹•ï¼Œä½†æ˜¯æ²¡è€ƒè™‘åˆ°è¿™æ ·è®¾ç½®åï¼Œä¸Šä¸‹çš„é«˜åº¦ä¼šæŒ‰æ¯”ä¾‹åˆ†å‰²æˆå„è‡ªå ä¸€åŠï¼Œè¿™ä¸ªé—®é¢˜ä¸€ç›´æ²¡æƒ³æ˜ç™½æ˜¯ä¸ºä»€ä¹ˆï¼Œæœ€åé€šè¿‡ **react-devtools** å‘ä¸‹ä¸‹éƒ¨å…ƒç´ é«˜åº¦å äº†ä¸€åŠï¼Œæ‰å‘ç°é—®é¢˜æ ¹æº



### å±è”½é¡µé¢ä¸­å‡ºçš„é»„å±è­¦å‘Šæ–¹æ³•ï¼š

```jsx
console.disableYellowBox = true;
console.warn('YellowBox is disabled.');
```



### render çš„ returnå‡½æ•°ä¸èƒ½å†™å¤šè¡Œè¯­å¥ï¼Œåªèƒ½å†™è¡¨è¾¾å¼

åœ¨ **render çš„ returnå‡½æ•°é‡Œ**ï¼Œå³`JSX`ä¸­ä¸èƒ½å†™å¤šè¡Œè¯­å¥ï¼Œåªèƒ½å†™è¡¨è¾¾å¼ï¼Œå¤šè¡Œè¯­å¥çš„é€»è¾‘å¤„ç†ä¸€èˆ¬æ”¾åœ¨ **return**å‡½æ•°ä¹‹å‰ã€‚jxsçš„è¡¨è¾¾å¼å†™æ³•ï¼Œå‚è€ƒï¼š [React æ¡ä»¶æ¸²æŸ“](https://doc.react-china.org/docs/conditional-rendering.html)  ã€‚ç°åœ¨è€ƒè™‘ä¸€ç§éœ€æ±‚ï¼Œéœ€è¦æ ¹æ®ä¸€ä¸ªæ•°ç»„åŠ¨æ€æ¸²æŸ“ Image çš„æƒ…å†µï¼Œè¿™ç§å†™æ³•ä¸€èˆ¬ç”±ä¸¤ç§å†™æ³•ï¼š

```jsx
// ---------------------------------------------  ç¬¬ä¸€ç§å†™æ³•ï¼Œåœ¨returnå‡½æ•°ä¹‹å‰å¤„ç†
//åœ¨ return å‡½æ•°ä¹‹å‰å†™ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨mapå‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å¾ªç¯è¯­å¥
let picList = picArray.map((item) => {
        return (<Image></Image>);
    }
);

return (
	{picList}
)
```


    // ---------------------------------------------  ç¬¬ä¸€ç§å†™æ³•ï¼Œåœ¨return å‡½æ•°å†…å†™ï¼Œä½¿ç”¨mapå‡½æ•°
    return (
        {
            picArray.map((item) => {
            	return (<Image></Image>);
        	}
        }
    )
    ```
    
    å‚è€ƒï¼š [åœ¨renderå‡½æ•°ä¸­æ€ä¹ˆä½¿ç”¨forå¾ªç¯](http://bbs.reactnative.cn/topic/845/%E5%9C%A8render%E5%87%BD%E6%95%B0%E4%B8%AD%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8for%E5%BE%AA%E7%8E%AF)



### æšä¸¾å®ç°ã€å¸¸é‡å®ç°

```jsx
//æšä¸¾
export const RefreshState = {
    Idle: 0,
    HeaderRefreshing: 1,
    FooterRefreshing: 2,
    NoMoreData: 3,
    Failure: 4,
    EmptyData: 5,
}

//å¸¸é‡å†™æ³•
    static defaultProps = {
        footerRefreshingText: 'æ•°æ®åŠ è½½ä¸­â€¦',
        footerFailureText: 'ç‚¹å‡»é‡æ–°åŠ è½½',
        footerNoMoreDataText: 'å·²åŠ è½½å…¨éƒ¨æ•°æ®',
        footerEmptyDataText: 'æš‚æ—¶æ²¡æœ‰ç›¸å…³æ•°æ®',
    }
```



### å¼•å…¥å…¶ä»–æ–‡ä»¶çš„å†™æ³•

```jsx
import RefreshListView, {RefreshState} from 'react-native-refresh-list-view';
```



### å­—ç¬¦ä¸²è½¬æ•°å­—ã€æ•°å­—è½¬å­—ç¬¦ä¸²

```jsx
//å­—ç¬¦ä¸²è½¬æ•°å­—	parseInt()ã€parseFloat()
var num1 = parseInt("1234blue");
var num6 = parseInt("70");

//æ•°å­—è½¬å­—ç¬¦ä¸²	 toString()
var num = 10;
num.toString()

```



### ScrollViewå†…éƒ¨é«˜åº¦è®¡ç®—é—®é¢˜

åœ¨ ScrollView é‡Œï¼Œå¦‚æœè®¾ç½®äº†ScrollViewçš„paddingï¼Œç„¶ååˆè®¾ç½®äº† flex æˆ–å®½é«˜ï¼Œå†…éƒ¨é«˜åº¦è®¡ç®—ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºå†…éƒ¨é«˜åº¦è®¡ç®—æ˜¯æŒ‰ç…§ flex æˆ– è®¾å®šçš„å®½é«˜æ¥è®¡ç®—ï¼Œpaddingå€¼æ²¡æœ‰è®¡ç®—åˆ°å†…ï¼Œå¯èƒ½åº•éƒ¨æœ‰å†…å®¹ä¼šæ»‘åŠ¨ä¸ä¸Šæ¥ï¼Œè¿™ç§æƒ…å†µï¼Œå»ºè®®å†…éƒ¨å…ƒç´ ç”¨ margin æ¥å®ç°ã€‚å¦å¤–ï¼Œå¦‚æœéœ€è¦scrollvewè‡ªåŠ¨è®¡ç®—é«˜åº¦ï¼Œæœ¬èº« å’Œ çˆ¶å®¹å™¨éƒ½è¦ç¡®å®šé«˜åº¦æˆ–è®¾å®šflex



### RNé¡µé¢PUSHæ‰å¸§å¡é¡¿é—®é¢˜

åœ¨RNé¡µé¢ä¹‹é—´è¿›è¡Œpushçš„æ—¶å€™ï¼Œä¼šå‘ç°æœ‰æ‰å¸§çš„ç°è±¡ï¼Œé¡µé¢ä¼šå‡ºç°å¡é¡¿ï¼Œè¿™ä¸ªå®˜ç½‘ä¹Ÿç»™äº†è¯´æ˜ï¼Œå¤§æ¦‚æ„æ€æ˜¯è¯´å› ä¸ºè¿›å…¥é¡µé¢åšäº†å¾ˆå¤šæ“ä½œï¼Œå½“å‡ºç°å¼€é”€å¾ˆå¤§çš„å­ç»„ä»¶æ•°é‡ç»˜çš„æ—¶å€™ï¼ŒJSæ§åˆ¶çš„åŠ¨ç”»å°±ä¼šå¡ä½ï¼Œå…³äºè¿™ç‚¹è¯¦è§ [æ€§èƒ½-JavaScript å¸§ç‡](https://reactnative.cn/docs/0.46/performance.html#content)ï¼Œå…¶ä¸­å®˜ç½‘ç»™çš„æ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨ [React Navigation](https://reactnavigation.org/) åº“ï¼Œè¿™ç‚¹å›å¤´å¯ä»¥ä»”ç»†ç ”ç©¶ä¸‹



### FlatList `initialNumToRender`é—®é¢˜

FlatList å¦‚æœåˆå§‹è®¾ç½®çš„ `initialNumToRender` å€¼è¿‡å°ï¼Œæ¸²æŸ“çš„æ•°é‡å°‘äºå±å¹•å¯æ˜¾ç¤ºçš„æ•°é‡ï¼Œé‚£ä¹ˆå±å¹•ä¼šç»˜åˆ¶ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¼šè§¦å‘ `onEndReached` æ–¹æ³•ï¼Œå¦‚æœè®¾ç½®äº†ä¸Šæ‹‰æ›´æ–°ï¼Œå°±ä¼šé”™è¯¯è§¦å‘è¯¥æ–¹æ³•ã€‚ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå¦‚æœä¸è®¾ç½® `initialNumToRender` è¯¥å€¼ï¼Œåˆ™ä¹Ÿä¼šè§¦å‘ `onEndReached` æ–¹æ³•ï¼Œæ€€ç–‘æ˜¯å¦‚æœä¸è®¾ç½®ï¼Œç³»ç»Ÿå¯èƒ½åˆæ¬¡æ¸²æŸ“çš„cellä¸ªæ•°æ¯”è¾ƒå°‘ã€‚æˆ‘è¿™é‡Œç”¨çš„æ˜¯ 0.46.4 ç‰ˆæœ¬ï¼Œä¸çŸ¥é“åé¢çš„RNç‰ˆæœ¬æœ‰æ²¡æœ‰ä¼˜åŒ–FlatList



### FlatListæ»‘åŠ¨å¤šé¡µåä¼šé‡åˆ°è‡ªå·±ä¹±æ»šçš„ç°è±¡

ä»Šå¤©å›°æ‰°æˆ‘å¤šå¤©çš„é—®é¢˜è§£å†³äº†ï¼Œ**FlatListæ»‘åŠ¨å¤šé¡µåä¼šé‡åˆ°è‡ªå·±ä¹±æ»šçš„ç°è±¡**ï¼Œå›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œå¾ˆå¥‡æ€ªï¼Œç½‘ä¸Šå’Œç¾¤é‡Œéƒ½æ²¡é‡åˆ°è¿™ç§æƒ…å†µï¼Œå›°æ‰°äº†è‡ªå·±å¾ˆä¹…å¾ˆä¹…ï¼Œå·®ç‚¹æ”¾å¼ƒå†™RNï¼Œæœ€ååœ¨å¶ç„¶é—´å‘ç°æ˜¯è‡ªå·±çŠ¯äº†ä¸€ä¸ªå¾ˆäºŒçš„é”™è¯¯....

```js

//è¿™é‡Œæ˜¯åŸå§‹å†™æ³•
    _keyExtractor = (item, index) => {
        index;
    }
```

å¼€å§‹è‡ªå·±æœ‰ä¸ªå°è±¡ï¼Œè®°å¾—åœ¨æŸä¸ªåœ°æ–¹çœ‹è¿‡å¯ä»¥ä¸ç”¨å†™returnï¼Œjsçš„å‡½æ•°ä¼šå–æœ€åçš„å€¼ï¼Œæœ€åå‘ç°æ˜¯ä¸è¡Œçš„ï¼Œè¿™ä¸ªåœ°æ–¹ä¸€å®šè¦å†™return ï¼Œä¸å†™returnçš„æƒ…å†µæ˜¯å»å»æ‰ èŠ±æ‹¬å·çš„æƒ…å†µï¼Œæ¯”å¦‚ï¼š

```js
    //ç¬¬ä¸€ç§å†™æ³•ï¼ŒåŠ  return
	_keyExtractor = (item, index) => {
        return index;
    }
    
    //ç¬¬äºŒç§å†™æ³•ï¼Œä¸å†™returnï¼Œä½†æ˜¯è¦å»æ‰ èŠ±æ‹¬å·
	_keyExtractor = (item, index) => index;
    
```

çœŸçš„æ˜¯å¾ˆäºŒçš„é—®é¢˜â€¦å›°æ‰°äº†å¾ˆä¹…ï¼Œæ·¡ç–¼ğŸ˜ª



### **å‡½æ•°æŠ–åŠ¨**ä¸**å‡½æ•°èŠ‚æµ**

**å‡½æ•°æŠ–åŠ¨**ä¸**å‡½æ•°èŠ‚æµ**ï¼Œjsé‡Œé¢æœ‰è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œå¾ˆæœ‰æ„æ€ï¼Œå›å¤´ç ”ç©¶ä¸‹



### `RefreshListView`è§¦å‘ä¸¤æ¬¡è¯·æ±‚é—®é¢˜

åœ¨ä½¿ç”¨`RefreshListView`æ§ä»¶ä½œä¸ºä¸Šæ‹‰åˆ·æ–°çš„ç©ºé—´ï¼Œå‘ç°æ¯æ¬¡ä¸Šæ‹‰ï¼Œéƒ½ä¼šè§¦å‘ä¸¤æ¬¡ä¸Šæ‹‰åˆ·æ–°çš„å‡½æ•°ï¼Œä»è€Œè§¦å‘äº†ä¸¤æ¬¡è¯·æ±‚ï¼ŒåŸºæœ¬ç¡®å®šæ˜¯å½“åˆ·æ–°æ•°æ®åŒæ—¶ä¿®æ”¹åˆ·æ–°çŠ¶æ€çš„åï¼Œåˆå†æ¬¡è§¦å‘äº†æŸç§æœºåˆ¶ï¼Œå¯¼è‡´åœ¨ onScroll å‡½æ•°é‡Œè§¦å‘äº†æ–°çš„ä¸Šæ‹‰æ“ä½œï¼Œç»è¿‡æ–­ç‚¹å‘ç°æ­¤æ—¶çš„contentsizeè¿˜æ˜¯ä¸Šæ¬¡çš„ã€‚å…·ä½“åŸå› æŸ¥æ‰¾ä¸åˆ°ï¼Œæœ€ç»ˆæ— å¥ˆé‡‡ç”¨äº†å»¶æ—¶500msä¿®æ”¹åˆ·æ–°çŠ¶æ€çš„æ“ä½œ

```jsx
//ä¼šå¯¼è‡´ä¸Šæ‹‰åˆ·æ–°è§¦å‘ä¸¤æ¬¡çš„ä»£ç 
this.setState({
    dataList: array,
    refreshState: nomoredata? RefreshState.NoMoreData:RefreshState.Idle,
})

//è¿›è¡Œå»¶æ—¶ä¿®æ”¹ä¸Šæ‹‰åˆ·æ–°çŠ¶æ€çš„ä»£ç 
this.setState({
    dataList: array,
})

setTimeout(
    () => {
    	this.setState({
        	refreshState: nomoredata? RefreshState.NoMoreData:RefreshState.Idle,
    	})
    },500)

```



### æ— çŠ¶æ€ç»„ä»¶

```jsx
const ReactFormLabel = (props) =>(
    <label htmlFor={props.htmlFor}>{props.title}</label>
);
```



### æ‰“å¼€ä¸€ä¸ªæ–°é¡µé¢çš„å†™æ³•ï¼ˆé¡¹ç›®å†…éƒ¨ï¼‰

```jsx

//ç»§æ‰¿TCPage
//ç„¶åè°ƒç”¨
this.openNewPage(this.props.navigation, 'CommentDetail',dic);
```



### å¤šé¡µé¢å…±äº«å˜é‡é—®é¢˜

```jsx
//éœ€æ±‚ï¼Œå¤šä¸ªJsæ–‡ä»¶ï¼Œè¦å…±äº«ä¸€äº›å˜é‡

//åœ¨Index.js æ–‡ä»¶å†…å®šä¹‰
export let GlobalContext = {
    memberId: null,
    userName: null,
}

//åœ¨å…¶ä»–æ–‡ä»¶å†…
import {GlobalContext} from  './Index';
ç„¶åå°±å¯ä»¥åœ¨è¯¥æ–‡ä»¶å†…ä½¿ç”¨ GoablContext å˜é‡äº†
```



